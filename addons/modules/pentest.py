from PyQt5.QtWidgets import QWidget, QVBoxLayout, QLabel, QTextEdit, QPushButton, QHBoxLayout
from src.util.safe_exec import SafeExecutor
import logging
log = logging.getLogger(__name__)
class Pentest(QWidget):
    def __init__(self):
        super().__init__()
        lay = QVBoxLayout(self); lay.setContentsMargins(12,12,12,12)
        lay.addWidget(QLabel("Open-source tools (safe runners)"))
        self.out = QTextEdit(); self.out.setReadOnly(True); lay.addWidget(self.out)
        row = QHBoxLayout(); lay.addLayout(row)
        self.exec = SafeExecutor(on_line=lambda s: self.out.append(s))
        b1 = QPushButton("Run nmap localhost"); b1.clicked.connect(lambda: self.exec.run("nmap", ["-sV","127.0.0.1"])); row.addWidget(b1)
        b2 = QPushButton("Check tshark"); b2.clicked.connect(lambda: self.exec.run("tshark", ["-v"])); row.addWidget(b2)
        b3 = QPushButton("Check snort"); b3.clicked.connect(lambda: self.exec.run("snort", ["-V"])); row.addWidget(b3)